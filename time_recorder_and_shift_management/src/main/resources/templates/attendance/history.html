<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">

<head>
	<meta charset="utf-8">
	<title>勤怠履歴</title>
	<link rel="stylesheet" th:href="@{/css/mystyle.css}">
	<meta name="viewpoint" content="width=device-width">
</head>

<body>
	<header>
		<nav style="height:auto">
			<ul th:with="thisMonth=${#dates.month(#dates.createNow())}" style="margin:0;">
				<div th:each="month:${#numbers.sequence(1,thisMonth)}" style="display:inline">
					<li><a th:href="@{/attendance/{month}(month=${month})}" th:text="|${month}月|"></a></li>
				</div>
				<li class="li-admin" >
					<a th:href="${referer}=='http://localhost:8080/user'?@{/user}:@{/admin}">戻る</a>
				</li>
			</ul>
			<ul sec:authorize="hasAuthority('ADMIN')" style="margin:0;">
				<li><a th:href="@{/attendance/{targetMonth}(targetMonth=${targetMonth})}">全員</a></li>
				<div th:each="employee : ${employees}" style="display:inline">
					<li><a th:href="@{/attendance/{targetMonth}/{employee_id}(targetMonth=${targetMonth},employee_id=${employee.id})}"
						th:text="${employee.name}"></a></li>
				</div>
			</ul>
		</nav>
	</header>
	<article>
		<h1>勤怠履歴</h1>
		<p th:if="${message}" th:text="${message}" style="color:blue">完了メッセージ</p>
		<p th:if="${errorMessage}" th:text="${errorMessage}" style="color:red">エラーメッセージ</p>
		<table class="history">
			<thead>
				<tr>
					<th>日付</th>
					<th>曜日</th>
					<th>名前</th>
					<th>出勤時刻</th>
					<th>退勤時刻</th>
					<th>実働時間</th>
					<th sec:authorize="hasAuthority('ADMIN')">作成日時</th>
					<th sec:authorize="hasAuthority('ADMIN')">更新日時</th>
					<th sec:authorize="hasAuthority('ADMIN')">修正</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="history:${histories}">
					<th:block th:object="${history}">
						<td th:text="*{#temporals.format(date,'MM/dd')}"></td>
						<td th:text="*{#temporals.dayOfWeekNameShort(date)}"></td>
						<td th:text="*{employee.name}"></td>
						<td th:text="*{start}"></td>
						<td th:text="*{end}"></td>
						<td th:text="*{workTime}"></td>
						<td sec:authorize="hasAuthority('ADMIN')" th:text="*{#temporals.format(created_at,'yyyy-MM-dd hh:mm:ss')}"></td>
						<td sec:authorize="hasAuthority('ADMIN')" th:text="*{#temporals.format(updated_at,'yyyy-MM-dd hh:mm:ss')}"></td>
						<td sec:authorize="hasAuthority('ADMIN')" ><a th:href="@{/attendance/{id}(id=*{id})}">修正</a></td>
					</th:block>
				</tr>
			</tbody>
		</table>
	</article>
</body>

</html>